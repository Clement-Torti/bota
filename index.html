<!DOCTYPE html>
<html lang="es-DO">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bo'ta üá©üá¥</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-green: #02CB01;
            --dark-green: #05B602;
            --hot-pink: #ff007f;
            --bright-yellow: #ffdd00;
            --white: #ffffff;
            --text-dark: #1a1a1a;
            --card-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; touch-action: manipulation; }

        body {
            font-family: 'Montserrat', sans-serif;
            background: repeating-linear-gradient(
                45deg,
                var(--neon-green),
                var(--neon-green) 20px,
                var(--dark-green) 20px,
                var(--dark-green) 40px
            );
            background-size: 200% 200%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: var(--text-dark);
            animation: moveStripes 25s linear infinite;
        }

        @keyframes moveStripes {
            0% {
                background-position: 0% 0%;
            }
            100% {
                background-position: 100% 100%;
            }
        }

        /* HEADER */
        header {
            text-align: center;
            padding: 15px;
            z-index: 10;
            position: relative;
            flex-shrink: 0; /* No encoger */
        }

        header h1 {
            font-size: 2rem;
            font-weight: 900;
            color: var(--white);
            text-transform: uppercase;
            text-shadow: 3px 3px 0px var(--hot-pink);
            font-style: italic;
            line-height: 1;
        }

        header span {
            font-weight: 700;
            color: var(--text-dark);
            background: var(--bright-yellow);
            padding: 2px 10px;
            transform: rotate(-2deg);
            display: inline-block;
            margin-top: 5px;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.2);
        }

        /* MAIN APP */
        .app-container {
            flex: 1;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
        }

        /* STACK DE CARTAS */
        .card-stack {
            position: relative;
            width: 90%;
            height: 65vh;
            perspective: 1000px;
        }

        .card {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--white);
            border-radius: 25px;
            box-shadow: var(--card-shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: transform 0.3s ease, opacity 0.3s ease;
            transform-origin: 50% 100%;
            border: 4px solid var(--white);
        }

        .card:nth-last-child(1) { z-index: 3; }
        .card:nth-last-child(2) { z-index: 2; transform: scale(0.95) translateY(15px); opacity: 0.9; }
        .card:nth-last-child(3) { z-index: 1; transform: scale(0.90) translateY(30px); opacity: 0.8; }
        .card:nth-last-child(n+4) { opacity: 0; pointer-events: none; }

        .card-image {
            width: 100%;
            height: 45%;
            object-fit: cover;
            background: #eee;
            border-bottom: 5px solid var(--hot-pink);
        }

        .card-content {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .category-badge {
            background: var(--text-dark);
            color: var(--bright-yellow);
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 800;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .proposition-text {
            font-size: 1.2rem;
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: 15px;
            color: #333;
        }

        .saber-mas {
            margin-top: auto;
            color: var(--hot-pink);
            text-decoration: none;
            font-weight: 700;
            border: 2px solid var(--hot-pink);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.8rem;
            transition: 0.2s;
        }
        
        .saber-mas:hover {
            background: var(--hot-pink);
            color: white;
        }

        /* CONTROLES */
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 20px;
            padding-bottom: 30px;
            width: 100%;
            max-width: 480px;
            margin: 0 auto;
            z-index: 20;
        }

        .btn-action {
            width: 65px;
            height: 65px;
            border-radius: 50%;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 0 rgba(0,0,0,0.2);
            color: white;
        }

        .btn-action:active { transform: translateY(4px); box-shadow: 0 4px 0 rgba(0,0,0,0.2); }
        .btn-no { background: var(--hot-pink); }
        .btn-maybe { background: var(--bright-yellow); width: 50px; height: 50px; font-size: 1.5rem; color: var(--text-dark); }
        .btn-yes { background: #00C853; }

        /* OVERLAYS */
        .overlay {
            position: absolute;
            top: 40px;
            font-size: 3rem;
            font-weight: 900;
            padding: 5px 20px;
            border: 6px solid;
            border-radius: 12px;
            opacity: 0;
            z-index: 10;
            background: rgba(255,255,255,0.8);
        }
        .overlay-yes { left: 20px; color: #00C853; border-color: #00C853; transform: rotate(-15deg); }
        .overlay-no { right: 20px; color: var(--hot-pink); border-color: var(--hot-pink); transform: rotate(15deg); }
        .overlay-maybe { top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--bright-yellow); border-color: var(--bright-yellow); background: rgba(0,0,0,0.7); font-size: 2rem; }

        /* --- VISTA DE RESULTADOS --- */
        .results-view {
            display: none;
            position: absolute;
            top: 0; left: 0;
            width: 100%; 
            height: 100vh; /* Ocupa toda la pantalla */
            background: linear-gradient(180deg, var(--neon-green) 0%, #008f36 100%);
            z-index: 100;
            flex-direction: column;
            justify-content: space-between; /* Distribuye espacio */
            align-items: center;
            overflow: hidden;
        }

        .results-header {
            margin-top: 40px;
            text-align: center;
            color: white;
            flex-shrink: 0;
        }

        .podium-container {
            display: flex;
            align-items: flex-end; /* Alinea barras abajo */
            justify-content: center;
            width: 100%;
            /* ESTO ES CLAVE: Ocupa todo el espacio disponible en medio */
            flex-grow: 1; 
            padding-bottom: 90px; /* Espacio para que las barras no toquen el bot√≥n */
            padding-left: 10px;
            padding-right: 10px;
        }

        .podium-place {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            margin: 0 4px;
            width: 30%;
            height: 100%; /* Permite que crezcan hasta arriba */
            position: relative;
        }

        .place-1 { order: 2; width: 38%; z-index: 10; }
        .place-2 { order: 1; }
        .place-3 { order: 3; }

        .candidate-avatar-res {
            width: 60px; height: 60px;
            border-radius: 50%;
            border: 4px solid white;
            margin-bottom: -20px; /* Superposici√≥n */
            z-index: 5;
            background: #fff;
            display: flex;
            align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            position: relative;
        }
        
        .place-1 .candidate-avatar-res { width: 85px; height: 85px; font-size: 1.5rem; border-color: var(--bright-yellow); margin-bottom: -30px; }

        .podium-bar {
            width: 100%;
            background: white;
            border-radius: 15px 15px 0 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
            padding-bottom: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            /* Altura inicial 0 */
            height: 0;
            transition: height 1.2s cubic-bezier(0.34, 1.56, 0.64, 1); /* Efecto rebote */
            min-height: 40px; /* Para que siempre se vea algo */
        }

        .place-1 .podium-bar { background: var(--bright-yellow); color: var(--text-dark); }
        .place-2 .podium-bar { background: rgba(255,255,255,0.9); }
        .place-3 .podium-bar { background: rgba(255,255,255,0.8); }

        .score-text { font-weight: 900; font-size: 1.4rem; }
        .name-text { font-size: 0.75rem; font-weight: 700; margin-top: 2px; text-align: center; line-height: 1.1; padding: 0 5px; }

        .restart-btn {
            position: absolute;
            bottom: 25px;
            background: var(--hot-pink);
            color: white;
            border: none;
            padding: 15px 50px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 5px 0 #c20061;
            text-transform: uppercase;
            z-index: 200;
        }
        .restart-btn:active { transform: translateY(3px); box-shadow: 0 2px 0 #c20061; }

        .animate-avatar { opacity: 1; transform: translateY(0); }
    </style>
</head>
<body>

    <header>
        <h1>Bo'Ta</h1>
        <span>RD Decide üá©üá¥</span>
    </header>

    <div class="app-container">
        <!-- Tarjetas -->
        <div class="card-stack" id="cardStack"></div>
        
        <!-- Vista Resultados (Podio) -->
        <div class="results-view" id="resultsView">
            <div class="results-header">
                <h2 style="font-size:2rem; font-weight:900; text-shadow: 2px 2px 0 rgba(0,0,0,0.2);">¬°EL RANKING! üèÜ</h2>
                <p>Tu match pol√≠tico ideal</p>
            </div>
            
            <div class="podium-container" id="podiumContainer">
                <!-- Se inyecta con JS -->
            </div>

            <button class="restart-btn" onclick="location.reload()">Jugar otra vez</button>
        </div>
    </div>

    <div class="controls" id="controls">
        <button class="btn-action btn-no" onclick="triggerSwipe('left')">‚úñ</button>
        <button class="btn-action btn-maybe" onclick="triggerSwipe('up')">ü§î</button>
        <button class="btn-action btn-yes" onclick="triggerSwipe('right')">‚ù§</button>
    </div>

    <script>
        // --- DATA ---
        const candidates = [
            { id: 'c1', name: 'Luis El Presi', color: '#0056b3', score: 0, avatar: 'LP' },
            { id: 'c2', name: 'El Le√≥n', color: '#008000', score: 0, avatar: 'LF' },
            { id: 'c3', name: 'Abelito', color: '#800080', score: 0, avatar: 'AM' }
        ];

        const propositions = [
            {
                text: "¬øConstruir un muro fronterizo total con tecnolog√≠a?",
                category: "Seguridad",
                image: "https://images.unsplash.com/photo-1628135249495-2c0b02662c18?auto=format&fit=crop&q=80&w=600",
                stances: { c1: 1, c2: 1, c3: 0 } 
            },
            {
                text: "¬øApoyas las 3 causales para el aborto?",
                category: "Salud / Derechos",
                image: "https://images.unsplash.com/photo-1579684385127-1ef15d508118?auto=format&fit=crop&q=80&w=600",
                stances: { c1: 0, c2: -1, c3: -1 } 
            },
            {
                text: "¬øDebemos seguir subsidiando los combustibles?",
                category: "Econom√≠a",
                image: "https://images.unsplash.com/photo-1528669826296-c3a6cb375215?auto=format&fit=crop&q=80&w=600",
                stances: { c1: 1, c2: 1, c3: 1 } 
            },
            {
                text: "¬øM√°s inversi√≥n en turismo en Pedernales?",
                category: "Desarrollo",
                image: "https://images.unsplash.com/photo-1584132967334-10e028bd69f7?auto=format&fit=crop&q=80&w=600",
                stances: { c1: 1, c2: 0, c3: 0 } 
            },
            {
                text: "¬øMano dura militar en los barrios calientes?",
                category: "Seguridad",
                image: "https://images.unsplash.com/photo-1455642304185-c47262dc4a41?auto=format&fit=crop&q=80&w=600",
                stances: { c1: 0, c2: 1, c3: 1 } 
            }
        ];

        let currentCardIndex = 0;
        const stackElement = document.getElementById('cardStack');

        // --- INIT ---
        function init() {
            [...propositions].reverse().forEach((prop, index) => {
                const realIndex = propositions.length - 1 - index;
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.index = realIndex;
                card.innerHTML = `
                    <div class="overlay overlay-yes">¬°CLARO!</div>
                    <div class="overlay overlay-no">¬°NUNCA!</div>
                    <div class="overlay overlay-maybe">NI IDEA</div>
                    <img src="${prop.image}" class="card-image" alt="Tema" onerror="this.onerror=null;this.src='https://placehold.co/600x400/00E055/FFF?text=RD+Decide';">
                    <div class="card-content">
                        <div class="category-badge">${prop.category}</div>
                        <div class="proposition-text">${prop.text}</div>
                        <a href="https://google.com/search?q=${encodeURIComponent(prop.text)}" target="_blank" class="saber-mas" onclick="event.stopPropagation()">Saber m√°s +</a>
                    </div>
                `;
                addTouchLogic(card);
                stackElement.appendChild(card);
            });
        }

        function addTouchLogic(card) {
            let startX = 0, startY = 0, currentX = 0, currentY = 0, isDragging = false;
            const startDrag = (e) => {
                startX = e.type.includes('mouse') ? e.clientX : e.touches[0].clientX;
                startY = e.type.includes('mouse') ? e.clientY : e.touches[0].clientY;
                isDragging = true;
                card.style.transition = 'none';
            };
            card.addEventListener('touchstart', startDrag); card.addEventListener('mousedown', startDrag);

            const moveDrag = (e) => {
                if (!isDragging) return;
                currentX = (e.type.includes('mouse') ? e.clientX : e.touches[0].clientX);
                currentY = (e.type.includes('mouse') ? e.clientY : e.touches[0].clientY);
                let diffX = currentX - startX, diffY = currentY - startY, rotation = diffX / 10;

                if (Math.abs(diffY) > Math.abs(diffX) && diffY < -50) {
                     card.style.transform = `translateY(${diffY}px) scale(${1 - Math.abs(diffY)/1000})`;
                     card.querySelector('.overlay-maybe').style.opacity = Math.min(Math.abs(diffY) / 150, 1);
                } else {
                    card.style.transform = `translateX(${diffX}px) rotate(${rotation}deg)`;
                    if (diffX > 0) { card.querySelector('.overlay-yes').style.opacity = Math.min(diffX / 100, 1); } 
                    else { card.querySelector('.overlay-no').style.opacity = Math.min(Math.abs(diffX) / 100, 1); }
                }
            };
            window.addEventListener('touchmove', moveDrag); window.addEventListener('mousemove', moveDrag);

            const endDrag = () => {
                if (!isDragging) return;
                isDragging = false;
                let diffX = currentX - startX, diffY = currentY - startY;
                card.style.transition = 'transform 0.4s ease';
                if (diffX > 100) processSwipe('right', card);
                else if (diffX < -100) processSwipe('left', card);
                else if (diffY < -100) processSwipe('up', card);
                else { card.style.transform = ''; card.querySelectorAll('.overlay').forEach(el => el.style.opacity = 0); }
            };
            window.addEventListener('touchend', endDrag); window.addEventListener('mouseup', endDrag);
        }

        function triggerSwipe(direction) {
            const cards = document.querySelectorAll('.card');
            const topCard = cards[cards.length - 1]; 
            if (topCard) processSwipe(direction, topCard);
        }

        function processSwipe(direction, card) {
            const index = parseInt(card.dataset.index);
            const prop = propositions[index];
            if (direction !== 'up') {
                const userChoice = direction === 'right' ? 1 : -1;
                candidates.forEach(cand => {
                    const candidateStance = prop.stances[cand.id];
                    if (userChoice === candidateStance) cand.score += 1;
                });
            }
            let transString = direction === 'right' ? `translateX(${window.innerWidth}px) rotate(30deg)` : 
                              direction === 'left' ? `translateX(-${window.innerWidth}px) rotate(-30deg)` : 
                              `translateY(-${window.innerHeight}px) scale(0.5)`;
            card.style.transform = transString;
            card.style.opacity = '0';
            setTimeout(() => {
                card.remove();
                currentCardIndex++;
                if (currentCardIndex >= propositions.length) showResults();
            }, 300);
        }

        function showResults() {
            document.getElementById('controls').style.display = 'none';
            document.querySelector('header').style.display = 'none'; 
            const resultsView = document.getElementById('resultsView');
            resultsView.style.display = 'flex';
            
            candidates.sort((a, b) => b.score - a.score);
            const container = document.getElementById('podiumContainer');
            container.innerHTML = '';
            
            // Usamos un top 3
            const top3 = candidates.slice(0, 3);
            const maxScore = propositions.length;

            top3.forEach((cand, index) => {
                const rank = index + 1;
                const percent = maxScore > 0 ? Math.round((cand.score / maxScore) * 100) : 0;
                
                // ALTURAS DIN√ÅMICAS Y ALTAS
                // El 1ro ocupa hasta el 85% del espacio disponible verticalmente
                let heightBase = 0;
                if(rank === 1) heightBase = 85; 
                if(rank === 2) heightBase = 65; 
                if(rank === 3) heightBase = 45; 

                // Sumamos un extra basado en los puntos reales para que no sea est√°tico
                const finalHeight = Math.min(heightBase + (cand.score * 2), 95);

                const div = document.createElement('div');
                div.className = `podium-place place-${rank}`;
                div.innerHTML = `
                    <div class="candidate-avatar-res" style="color:${cand.color}">
                        ${cand.avatar}
                    </div>
                    <div class="podium-bar" style="--target-height: ${finalHeight}%;">
                        <span class="score-text">${percent}%</span>
                        <span class="name-text">${cand.name}</span>
                    </div>
                `;
                container.appendChild(div);
            });

            setTimeout(() => {
                document.querySelectorAll('.podium-bar').forEach(bar => {
                    bar.style.height = bar.style.getPropertyValue('--target-height');
                });
                document.querySelectorAll('.candidate-avatar-res').forEach((av, i) => {
                    setTimeout(() => av.classList.add('animate-avatar'), i * 200 + 800);
                });
            }, 100);
        }

        init();
    </script>
</body>
</html>